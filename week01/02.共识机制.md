### 请解释工作量证明（Proof of Work, PoW）的基本原理。为什么说 PoW 能确保区块链的安全性？
以比特币为例，在比特币中的分布式账本中，由谁来记账是一个难点，不可能所有人都能随意的往链上添加区块。为了解决这个问题，每一个想要往链上添加区块的节点（矿工）都需要解决复杂的计算，这种计算只能通过比拼算力的方式，不断调整区块头中的随机数（Nonce）计算出符合要求的结果（前导0的数量符合要求），才能争取到记账的权利。首个找到有效值的矿工会将这个区块广播到整个网络，并且获得比特币奖励。

**为什么说 PoW 能确保区块链的安全性？**

1. 每一个区块都会计算整个节点，计算出一个HashCode，一旦这个节点发生了变化，那么下一个节点的前置指针就会失效。想要更新某一个节点，就需要将剩下的节点都更新，但是这样需要非常庞大的算力，经济上可行性很低，这也避免了**双花**问题。
2. 51%攻击防御，分布式账本，每一个节点都会保存一个该账本的副本，只有一半以上的节点的数据一致，才认为这个数据是有效的。随着时间的推移，区块链上的区块会越来越多，这种攻击方式的难度也会越来越大。

### 权益证明（Proof of Stake, PoS）与工作量证明（PoW）相比有哪些优缺点？
1. PoW需要大量的节点去计算，这需要消耗大量的能量，很不环保；PoS通过资产抵押和持有时间来获取到记账权利分配的权重，而不是矿工间的算力竞争，大大减少了能耗支出。
2. PoW的方式算力会被集中在部分矿池中，那么获取到记账权力和矿工奖励的矿工，会有更大的概率集中在这几个矿池上；而PoS不依赖于矿工的算力
3. PoW为了降低分支生成的概率，区块的生成速度较慢，吞吐量很低，以BTC为例，一个区块生成的时间为10min，又要再经过 1 小时才能完成交易确认；PoS的吞吐量较高，以ETH为例，一个区块的生成时间仅需7s。
4. 拓展性方面，PoS可以支持智能合约的方式，大大提高了扩展性。

### 请描述委托权益证明（Delegated Proof of Stake, DPoS）的工作原理。它是如何提高区块链性能的？
1. **见证人**，DPoS中打包区块的责任由见证人负责。
2. **候选人**，只有满足要求的人才能成为候选人，并且候选人的信息将会被保存，以便投票者参考；一般想要成为候选人还需要支付一定的费用，这个费用远超打包的奖励，想要赚回这部分费用，需要打包上千个区块才行，这也是的候选人在成为见证人之后需要履行自己的义务。
3. **投票人**，只要持有资产，就可以根据候选人信息参与投票。

DPoS的运作规则：由投票人投票选举出见证人，这些见证人在一个被计算出来的周期内，轮流履行打包的义务。周期结束之后，将产生新一轮的投票选举，重新选举出见证人，循环这个过程。

DPoS一般用于**联盟链**中，这种区块链上的参与者较少，并发量不高，也不需要计算区块的创建者，大大提高了区块链的性能。

### 拜占庭容错（Byzantine Fault Tolerance, BFT）在区块链中的应用是什么？请给出一个使用 BFT 共识机制的区块链项目实例。
 是一种机制，在系统内部，即使存在某些恶意行为，也能达成共识，保证系统正常运行的机制。

实例：如 Hyperledger Fabric 和 Stellar。

### 什么是混合共识机制？请举例说明一种区块链使用的混合共识机制及其优点。
混合共识机制是指将两种或多种不同的共识算法结合使用，以综合各自的优势、弥补单一机制的不足。

Decred 是一个去中心化治理的区块链项目，其核心共识机制结合了**工作量证明（PoW）**和**权益证明（PoS）。**

优点：

1. 安全性，PoW中，需要满足51%攻击才能篡改数据；PoS中，攻击者又需要有足够的资产抵押，大大提升了攻击难度。
2. 效率，PoW 矿工离线时，PoS 投票仍可维持网络运行。PoS 投票率低时，PoW 确保基础出块不受影响。
3. 去中心化程度
+ **权力制衡**：
    - 矿工（PoW）负责出块，持币者（PoS）负责监督和治理。
    - 防止单一群体（如矿池或巨鲸）垄断决策权。
+ **动态调整**：
    - 链上投票可灵活调整 PoW/PoS 奖励比例、区块大小等参数。

### FLP 不可能定理有什么实际意义？
FLP：在一个异步通信的环境中，只要有一故障节点，那么久没有一个完美的共识算法可以实现一致性。

意义：指明了在现实环境中，想要保证一致性难度巨大。

### Paxos 算法的主要目的是什么？
Paxos 是一种在异步模型下设计的共识算法，它能够保证系统的正确性和容错性。

### Raft 算法如何简化了共识的过程？
Raft 将一致性问题划分为三个较为独立的子问题：领导选举、日志复制和安全性

1. 领导选举：参与者被划分成了领导者Leader、候选人Candidate、参与者Follower，当存在Leader的时候，系统内不会存在Candidate。在一个任期结束后，会重新发起一次选举，重新选举出下一任Leader。由Leader处理系统中的请求，当Follower收到请求后，会将请求转发给Leader。
2. 日志复制：当一个请求发来，Leader先将命令存入自己的日志中，然后广播给Follower。当大多数的Follower都复制了这条命令之后，Leader会通知这条命令已提交给所有的节点，Follower接收到消息后，就会更新本地的数据。
3. 安全性：一旦Leader失联，集群内的Follower会马上发起下一轮的选举，选举出新的Leader。当网络问题解决后，根据任期号来决定谁是Leader。重连后，原来的Leader发现系统重新选举出了Leader，那么这个Leader就会自动降级成Follower。

### CAP 定理中的三个属性是什么？
1. C：Consistency，强一致性，节点间的数据一致
2. A：Avaliability，高可用性，系统对于请求要在较短的时间内响应
3. P：Partition Tolerance，分区容错性，即使部分节点失联，系统也要照常运行

一般的系统只能做到保证两个，在一定程度上牺牲另一个特性。

### 在分布式系统中，什么是两阶段提交（2PC）？
1. 当系统想要发生数据变更的时候，先询问所有节点，是否可以提交事务
2. 当所有节点都回答了Yes后，那么通知所有的节点一起更新数据；否则回滚事务

这种方案，在第一阶段会造成系统的阻塞，而第二阶段又可能由于部分节点的故障，导致一致性被破坏。

### 为什么说拜占庭容错（BFT）算法对区块链技术很重要？
区块链上，参与者是多种多样的，部分节点可能会对系统做出恶意攻击。BFT就是在这种情况下，也能够保证系统节点达成共识。

### 解释什么是日志复制在 Raft 算法中的作用？
在Leader执行一个操作时，先将这个操作写入到自己的日志中，然后吧这个操作不断向全网广播，接收到这个操作的Follower会将这个操作写入到日志，并返回确认给Leader。只有当大多数节点返回Ack，那么才说明这个操作被大多数节点认可，或者可行，这个操作事务才会执行。这样的行为维护了系统的一致性。

### 在选择共识算法时应考虑哪些关键因素？
1. 安全性
2. 一致性，多个节点的结果要保持一致
3. 能耗，挖矿会消耗大量的现实资源
4. 吞吐量，每秒能够接受的交易数量
5. 去中心化程度
6. 延迟
7. 可扩展性

**回答要点**:

+ 在选择共识算法时，应考虑的关键因素包括系统的容错需求、性能需求（如延迟和吞吐量）、系统规模（节点数量）、安全性要求、网络条件（如是否存在网络分区）以及系统的运行环境是否信任。

### 比特币使用的 PoW 算法如何解决记账的一致性问题？
1. 每一个区块都会计算整个节点，计算出一个HashCode，一旦这个节点发生了变化，那么下一个节点的前置指针就会失效。想要更新某一个节点，就需要将剩下的节点都更新，但是这样需要非常庞大的算力，经济上可行性很低，这也避免了**双花**问题。
2. 51%攻击防御，分布式账本，每一个节点都会保存一个该账本的副本，只有一半以上的节点的数据一致，才认为这个数据是有效的。随着时间的推移，区块链上的区块会越来越多，这种攻击方式的难度也会越来越大。

### PoW 算法中的「难度值」是如何工作的？
每2016个区块，就会统计这2016个区块的统计生成时间，动态的调整难度值，保证每一个区块的产出时间在10min。

### 什么是权益证明（PoS）共识算法？
PoS要求每一个矿工都要提供一定的资产抵押，然后根据每个矿工的资产占比来分配区块打包上链的权力。履行义务的矿工才能获取到奖励，试图破坏规则的矿工会被扣除抵押的数字资产。这种方式不再需要依赖到矿工的算力。

### PoS 中的「币龄」是如何计算的？
coinage = k * balance * age，表示虚拟资产的持有时间，持有时间越长的矿工越容易获取到打包的资格。

### 描述 DPoS 共识算法的主要工作原理。
DPoS算法多用于联盟联中。

1. 优势：PoW需要依赖节点算力，PoS需要依赖节点持有的资产，都存在一定的中心化风险。DPoS通过投票的方式，只要链上节点持有相应的数字资产，就可以参与投票，选举出见证人来维护这个系统。这种机制保证了系统的安全性和效率，可以提高网络的效率和扩展性。
2. DPoS中，分为以下几个角色：
    1. 见证人：见证人负责区块的打包上链
    2. 候选人：满足条件可以成为见证人的参与者，一般需要提供提供候选人的信息，一共投票人参考
    3. 投票人：只要持有链上的虚拟资产，就可以参与投票选举见证人
    4. 受托人：这个角色主要存在早期的DPoS系统中，主要责任是维护系统中的参数等信息，后面的DPoS系统已经不怎么需要这个角色了，只有见证人
3. 流程：想要成为见证人的节点提供自己的信息，并且支付一定的数字资产，成为候选人；然后投票人投票选举出见证人，见证人可以有多个，他们按照一定的顺序在任期内履行打包的义务。

### PBFT 算法如何实现共识？
在最多m个节点故障，节点数n=3m+1个节点的系统能够确保一致性，维持系统正常运行。通过多个阶段的事务提交来保证各个节点之间数据的一致性。

### PBFT 算法中的「视图更换」是什么意思？
在主节点失效的情况下，备份节点触发视图变更，会自主发起选举新的主节点，以维持系统的可用性。

### Casper 共识算法与传统 PoS 有什么不同？
1. 引入罚没条件，防止无利害攻击
2. 最终确定性机制，确保区块不可逆
3. 更严格的验证者管理和退出机制
4. 支持分片等拓展性功能
5. 混合模型，如FFG

